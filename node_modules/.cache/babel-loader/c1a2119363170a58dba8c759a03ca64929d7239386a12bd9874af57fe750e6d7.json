{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useContext, useEffect } from \"react\";\nimport { Cookies } from \"react-cookie\";\nimport { useNavigate } from \"react-router-dom\";\nimport AuthContext from \"../context/authContext\";\nexport const useAuth = () => {\n  _s();\n  let navigate = useNavigate();\n  const [userData, setUserData] = React.useState({\n    signedIn: false,\n    user: null\n  });\n  const {\n    setAuthData\n  } = useContext(AuthContext);\n  useEffect(() => {\n    setAuthData(userData);\n  }, [userData.signedIn]);\n  function getAuthCookieExpiration() {\n    let date = new Date();\n    date.setTime(date.getTime() + 7 * 24 * 60 * 60 * 1000); // 7 days\n    return date;\n  }\n  function setAsLogged(user) {\n    const cookie = new Cookies();\n    cookie.set('is_auth', true, {\n      path: '/',\n      expires: getAuthCookieExpiration(),\n      sameSite: 'lax',\n      httpOnly: false\n    });\n    setUserData({\n      signedIn: true,\n      user\n    });\n    navigate('/');\n  }\n  function setLogout() {\n    const cookie = new Cookies();\n    cookie.remove('is_auth', {\n      path: '/',\n      expires: getAuthCookieExpiration(),\n      sameSite: 'lax',\n      httpOnly: false\n    });\n    setUserData({\n      signedIn: false,\n      user: null\n    });\n    navigate('/login');\n  }\n  function loginUserOnStartup() {\n    const cookie = new Cookies();\n    if (cookie.get('is_auth')) {\n      axios.post('/api/me').then(response => {\n        setUserData({\n          signedIn: true,\n          user: response.data.user\n        });\n        navigate('/');\n      }).catch(error => {\n        setUserData({\n          signedIn: false,\n          user: null\n        });\n        setLogout();\n      });\n    } else {\n      setUserData({\n        signedIn: false,\n        user: null\n      });\n      navigate('/login');\n    }\n  }\n  return {\n    userData,\n    setAsLogged,\n    setLogout,\n    loginUserOnStartup\n  };\n};\n_s(useAuth, \"CSWz4uF5rSEFaJCDZSrn/hNkB8I=\", false, function () {\n  return [useNavigate];\n});","map":{"version":3,"names":["React","useContext","useEffect","Cookies","useNavigate","AuthContext","useAuth","_s","navigate","userData","setUserData","useState","signedIn","user","setAuthData","getAuthCookieExpiration","date","Date","setTime","getTime","setAsLogged","cookie","set","path","expires","sameSite","httpOnly","setLogout","remove","loginUserOnStartup","get","axios","post","then","response","data","catch","error"],"sources":["/home/sfn/react-news-feed/src/Hooks/useAuth.js"],"sourcesContent":["import React, {useContext, useEffect} from \"react\";\nimport {Cookies} from \"react-cookie\";\nimport {useNavigate} from \"react-router-dom\";\n\nimport AuthContext from \"../context/authContext\";\n\nexport const useAuth = () => {\n    let navigate = useNavigate();\n\n    const [userData, setUserData] = React.useState({signedIn: false, user: null});\n\n    const {setAuthData} = useContext(AuthContext);\n\n    useEffect(() => {\n        setAuthData(userData);\n    }, [userData.signedIn]);\n\n    function getAuthCookieExpiration()\n    {\n        let date = new Date();\n        date.setTime(date.getTime() + (7 * 24 * 60 * 60 * 1000));  // 7 days\n        return date;\n    }\n\n    function setAsLogged(user) {\n\n        const cookie = new Cookies();\n\n        cookie.set('is_auth', true, {path: '/', expires: getAuthCookieExpiration(), sameSite: 'lax', httpOnly: false});\n\n        setUserData({signedIn: true, user});\n\n        navigate('/');\n    }\n\n    function setLogout() {\n        const cookie = new Cookies();\n\n        cookie.remove('is_auth', {path: '/', expires: getAuthCookieExpiration(), sameSite: 'lax', httpOnly: false});\n\n        setUserData({signedIn: false, user: null});\n\n        navigate('/login');\n    }\n\n    function loginUserOnStartup()\n    {\n        const cookie = new Cookies();\n        if(cookie.get('is_auth')) {\n\n            axios.post('/api/me').then(response => {\n                setUserData({signedIn: true, user: response.data.user});\n                navigate('/');\n            }).catch(error => {\n                setUserData({signedIn: false, user: null});\n                setLogout();\n            });\n\n        } else {\n            setUserData({signedIn: false, user: null});\n            navigate('/login');\n        }\n    }\n\n    return {\n        userData,\n        setAsLogged,\n        setLogout,\n        loginUserOnStartup\n    }\n\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}